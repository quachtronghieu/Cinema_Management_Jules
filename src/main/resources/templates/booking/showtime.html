<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{fragment/frag :: head_dashboard}"></head>

<style>
    body.bg-cream {
        background-color: #0e0e0e;
        color: white;
    }

    /* ðŸŒŸ Weekday buttons */
    .date-btn {
        background-color: #1a1a1a;
        color: #fff;
        border: 1px solid #333;
        transition: all 0.3s ease;
        width: 70px;
        height: 70px;
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .date-btn:hover, .date-btn.active {
        background-color: #e50914;
        color: #fff;
        border-color: #e50914;
        transform: translateY(-3px);
    }

    /* ðŸŽ¬ Showtime slot buttons */
    .showtime-btn {
        border: 2px solid #e50914;
        color: #e50914;
        background-color: transparent;
        padding: 6px 16px;
        border-radius: 8px;
        font-weight: 600;
        min-width: 120px;
        text-align: center;
        transition: all 0.25s ease;
    }

    .showtime-btn:hover {
        background-color: #e50914;
        color: white;
        box-shadow: 0 0 8px rgba(229, 9, 20, 0.6);
    }

    /* ðŸ–¼ Movie poster styling */
    .poster-card {
        position: relative;
        overflow: hidden;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.4);
        transition: transform 0.3s;
        max-width: 260px;
        margin: auto;
    }

    .poster-card:hover {
        transform: scale(1.03);
    }

    .poster-card img {
        width: 100%;
        height: 380px;
        object-fit: cover;
        border-radius: 15px;
    }

    h1.section-title {
        color: white;
        font-weight: 700;
        font-size: 2.5rem;
    }

    h3.movie-title {
        color: white;
        font-weight: 700;
    }

    .badge-age {
        background-color: #ffc107;
        color: #000;
        font-weight: bold;
    }
</style>

<body class="bg-cream">
<nav th:replace="~{fragment/frag :: navbar_homepage}"></nav>

<main class="py-5">
    <section class="container text-center">
        <h1 class="section-title mb-5" th:text="${movie.title}">Movie Title</h1>

        <!-- ðŸ”¹ Week navigation -->
        <div class="d-flex justify-content-center align-items-center gap-2 mb-4">
            <!-- NÃºt ngÃ y trÆ°á»›c -->
            <a th:href="@{/booking/{movieId}(movieId=${movie.movieID}, date=${#temporals.format(prevDate,'yyyy-MM-dd')})}"
               class="btn btn-outline-light rounded-circle px-3">&laquo;</a>

            <!-- CÃ¡c ngÃ y trong tuáº§n -->
            <a th:each="d : ${days}"
               th:href="@{/booking/{movieId}(movieId=${movie.movieID}, date=${#temporals.format(d,'yyyy-MM-dd')})}"
               th:classappend="${d.equals(selectedDate)} ? 'active' : ''"
               class="date-btn">
                <small th:text="${#temporals.format(d,'EEE').toUpperCase()}">MON</small>
                <span th:text="${#temporals.format(d,'dd')}">04</span>
            </a>

            <!-- NÃºt ngÃ y káº¿ tiáº¿p -->
            <a th:href="@{/booking/{movieId}(movieId=${movie.movieID}, date=${#temporals.format(nextDate,'yyyy-MM-dd')})}"
               class="btn btn-outline-light rounded-circle px-3">&raquo;</a>
        </div>


        <!-- ðŸ”¹ If empty -->
        <div class="alert alert-warning text-center w-75 mx-auto mt-5"
             th:if="${#maps.isEmpty(scheduleGroups)}">
            No showtimes available for this date.
        </div>

        <!-- ðŸ”¹ Movie Detail + Schedule -->
        <!-- ðŸ”¹ Movie Detail + Schedule -->
        <div class="border-top border-secondary py-5" th:if="${movie != null}">
            <div class="row justify-content-center align-items-start g-4">

                <!-- Poster -->
                <div class="col-md-3 text-center">
                    <div class="poster-card">
                        <img th:src="@{${movie.img}}" alt="poster">
                    </div>
                </div>

                <!-- Info -->
                <div class="col-md-6 text-start">
                    <h3 class="movie-title mb-2" th:text="${movie.title}">Movie Title</h3>

                    <p class="mb-3">
                        <span class="badge badge-age me-2" th:text="${movie.ageRating}">T13</span>
                    </p>

                    <!-- ðŸ”¹ No showtimes for this movie -->
                    <div th:if="${#maps.isEmpty(scheduleGroups)}">
                        <span class="text-muted fst-italic">No showtimes available.</span>
                    </div>

                    <!-- ðŸ”¹ Showtimes by room -->
                    <div th:each="entry : ${scheduleGroups}">
                        <p class="fw-semibold text-light mb-1"
                           th:text="'Room: ' + ${entry.key}"></p>

                        <div class="d-flex flex-wrap gap-2">
                            <a th:each="slot : ${entry.value}"
                               th:text="|${#temporals.format(slot['startTime'],'HH:mm')} - ${#temporals.format(slot['endTime'],'HH:mm')}|"
                               th:href="@{/booking/seatMap/{showtimeId}(showtimeId=${slot['showtimeId']})}"
                               class="showtime-btn">
                            </a>
                        </div>
                    </div>


                </div>
            </div>
        </div>
    </section>
</main>

<footer th:replace="~{fragment/frag :: footer_homepage}"></footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
