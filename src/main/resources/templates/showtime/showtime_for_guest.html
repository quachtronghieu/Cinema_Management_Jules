<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CGV Movies - Your Movie Experience Begins Here</title>
    <meta name="description"
          content="Book movie tickets online at CGV. Watch the latest movies in premium cinemas with the best sound and picture quality.">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
          rel="stylesheet">
    <link rel="stylesheet" th:href="@{/assets/css/style.css}">
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}">

</head>

<style>
    body.bg-cream {
        background-color: #0e0e0e;
        color: white;
    }

    /* ðŸŒŸ Weekday buttons */
    .date-btn {
        background-color: #1a1a1a;
        color: #fff;
        border: 1px solid #333;
        transition: all 0.3s ease;
        width: 70px;
        height: 70px;
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .date-btn:hover, .date-btn.active {
        background-color: #e50914;
        color: #fff;
        border-color: #e50914;
        transform: translateY(-3px);
    }

    /* ðŸŽ¬ Showtime slot buttons */
    .showtime-btn {
        border: 2px solid #e50914;
        color: #e50914;
        background-color: transparent;
        padding: 6px 16px;
        border-radius: 8px;
        font-weight: 600;
        min-width: 120px;
        text-align: center;
        transition: all 0.25s ease;
    }

    .showtime-btn:hover {
        background-color: #e50914;
        color: white;
        box-shadow: 0 0 8px rgba(229, 9, 20, 0.6);
    }

    /* ðŸ–¼ Movie poster styling */
    .poster-card {
        position: relative;
        overflow: hidden;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.4);
        transition: transform 0.3s;
        max-width: 260px;
        margin: auto;
    }

    .poster-card:hover {
        transform: scale(1.03);
    }

    .poster-card img {
        width: 100%;
        height: 380px;
        object-fit: cover;
        border-radius: 15px;
    }

    h1.section-title {
        color: white;
        font-weight: 700;
        font-size: 2.5rem;
    }

    h3.movie-title {
        color: white;
        font-weight: 700;
    }

    .badge-age {
        background-color: #ffc107;
        color: #000;
        font-weight: bold;
    }
</style>
<body>

<header th:replace="~{fragment/frag :: navbar_homepage}"></header>
<main class="py-5">
    <section class="container text-center">
        <h1 class="section-title mb-5">Showtimes</h1>

        <!-- ðŸ”¹ Week navigation -->
        <div class="d-flex justify-content-center align-items-center gap-2 mb-4">
            <a th:href="@{'/homepage/showtimes'(date=${#temporals.format(prevDate,'yyyy-MM-dd')})}"
               class="btn btn-outline-light rounded-circle px-3">&laquo;</a>

            <a th:each="d : ${days}"
               th:href="@{'/homepage/showtimes'(date=${#temporals.format(d,'yyyy-MM-dd')})}"
               th:classappend="${d.equals(selectedDate)} ? 'active' : ''"
               class="date-btn">
                <small th:text="${#temporals.format(d,'EEE').toUpperCase()}">MON</small>
                <span th:text="${#temporals.format(d,'dd')}">04</span>
            </a>



            <a th:href="@{'/homepage/showtimes'(date=${#temporals.format(nextDate,'yyyy-MM-dd')})}"
               class="btn btn-outline-light rounded-circle px-3">&raquo;</a>
        </div>

        <!-- ðŸ”¹ If empty -->
        <div class="alert alert-warning text-center w-75 mx-auto mt-5"
             th:if="${hasShowtimes != true}">
            No showtime available for this date.
        </div>
        <!-- ðŸ”¹ Movie section -->
        <div th:each="movie : ${movieList}"
             class="border-top border-secondary py-5">
            <div th:if="${scheduleGroups[movie.movieID] != null}"
                 class="row justify-content-center align-items-start g-4">
                <!-- Poster -->
                <div class="col-md-3 text-center">
                    <div class="poster-card">
                        <img th:src="@{${movie.img}}" alt="poster">
                    </div>
                </div>

                <!-- Info -->
                <div class="col-md-6 text-start">
                    <h3 class="movie-title mb-2" th:text="${movie.title}">Movie Title</h3>

                    <p class="mb-3">
                        <span class="badge badge-age me-2" th:text="${movie.ageRating}">T13</span>
                    </p>

                    <!-- Showtimes grouped by room -->
                    <div th:each="room : ${scheduleGroups[movie.movieID]}" class="mb-4">
                        <p class="fw-semibold text-light mb-1"
                           th:text="'Room: ' + ${room['roomName']}">Room 1</p>

                        <div class="d-flex flex-wrap gap-2">
                            <a th:each="slot : ${room['slots']}"
                               th:text="|${#temporals.format(slot['startTime'],'HH:mm')} - ${#temporals.format(slot['endTime'],'HH:mm')}|"
                               th:href="@{'/booking/seatMap/' + ${slot['showtimeId']}}"
                               class="showtime-btn">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </section>
</main>

<footer th:replace="~{fragment/frag :: footer_homepage}"></footer>

<!-- JS -->
<script th:src="@{/assets/js/hero.js}"></script>
<script th:src="@{/assets/js/movies.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
</body>
</html>
