<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragment/frag :: head_dashboard}"></head>

<style>
    body.bg-dark { background-color: #0e0e0e; color: white; }
    .date-btn { background-color: #1a1a1a; color: #fff; border: 1px solid #333;
        transition: all 0.3s ease; width: 70px; height: 70px; border-radius: 15px; }
    .date-btn:hover, .date-btn.active { background-color: #dc3545; color: #fff; transform: translateY(-3px); }
    .showtime-btn { border: 2px solid #dc3545; color: #dc3545; padding: 6px 16px;
        border-radius: 8px; font-weight: 600; min-width: 120px; text-align: center; transition: all 0.25s ease; }
    .showtime-btn:hover { background-color: #dc3545; color: white; }
    .poster-card img { width: 100%; height: 360px; object-fit: cover; border-radius: 15px; }
</style>

<body class="bg-dark">
<nav class="navbar navbar-dark bg-black px-4">
    <a class="navbar-brand fw-bold text-danger" th:href="@{/staff}">D&D Cashier</a>
    <div class="ms-auto d-flex gap-3 align-items-center">
        <span class="text-light small">Role: <b class="text-warning">Cashier</b></span>
        <a th:href="@{/logout}" class="btn btn-outline-danger btn-sm">Logout</a>
    </div>
</nav>

<main class="container py-5">
    <h1 class="text-center mb-5 text-danger fw-bold">Select Showtime</h1>

    <!-- ðŸ”¹ Week navigation -->
    <div class="d-flex justify-content-center align-items-center gap-2 mb-4">
        <a th:href="@{'/cashier/showtimes'(date=${#temporals.format(prevDate,'yyyy-MM-dd')})}"
           class="btn btn-outline-light rounded-circle px-3">&laquo;</a>

        <a th:each="d : ${days}"
           th:href="@{'/cashier/showtimes'(date=${#temporals.format(d,'yyyy-MM-dd')})}"
           th:classappend="${d.equals(selectedDate)} ? 'active' : ''"
           class="date-btn text-center">
            <small th:text="${#temporals.format(d,'EEE').toUpperCase()}">MON</small>
            <span th:text="${#temporals.format(d,'dd')}">04</span>
        </a>

        <a th:href="@{'/cashier/showtimes'(date=${#temporals.format(nextDate,'yyyy-MM-dd')})}"
           class="btn btn-outline-light rounded-circle px-3">&raquo;</a>
    </div>

    <!-- ðŸ”¹ Movie & showtime listing -->
    <div th:each="movie : ${movieList}" class="border-top border-secondary py-5">
        <div class="row align-items-start g-4">
            <div class="col-md-3">
                <div class="poster-card"><img th:src="@{${movie.img}}" alt=""></div>
            </div>

            <div class="col-md-6">
                <h3 class="fw-bold text-light" th:text="${movie.title}">Movie Title</h3>
                <p><span class="badge bg-warning text-dark" th:text="${movie.ageRating}">T13</span></p>

                <div th:if="${#lists.isEmpty(scheduleGroups[movie.movieID])}">
                    <span class="text-muted fst-italic">No showtimes available.</span>
                </div>

                <div th:each="room : ${scheduleGroups[movie.movieID]}" class="mb-3">
                    <p class="fw-semibold text-light mb-1" th:text="'Room: ' + ${room['roomName']}"></p>
                    <div class="d-flex flex-wrap gap-2">
                        <a th:each="slot : ${room['slots']}"
                           th:text="|${#temporals.format(slot['startTime'],'HH:mm')} - ${#temporals.format(slot['endTime'],'HH:mm')}|"
                           th:href="@{'/cashier/booking/' + ${movie.movieID} + '(time=' + ${#temporals.format(slot['startTime'],'HH:mm')} + ',date=' + ${#temporals.format(selectedDate,'yyyy-MM-dd')} + ')'}"
                           class="showtime-btn">09:00 - 11:15</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<footer class="text-center text-secondary py-3 border-top border-secondary">
    Â© 2025 D&D Cinema | Cashier Panel
</footer>
</body>
</html>
